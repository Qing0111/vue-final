"use strict";(self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[]).push([[486],{4677:function(t,e,a){var s=a(4311),o=a(1020),l=a(6294);const i=(0,l.Z)();e["Z"]=(0,o.Q_)("cartStore",{state:()=>({cart:{}}),actions:{addToCart(t){console.log(t),i.cartLoading=t;const e="https://vue3-course-api.hexschool.io/api/qing-api/cart",a={product_id:t,qty:1};s.Z.post(e,{data:a}).then((t=>{i.cartLoading="",i.pushMessage(t,{title:"加入購物車"}),console.log(t),this.getCart()}))},getCart(){const t="https://vue3-course-api.hexschool.io/api/qing-api/cart";i.isLoading=!0,s.Z.get(t).then((t=>{console.log(t.data.data),this.cart=t.data.data,i.isLoading=!1}))},updateCart(t){const e=`https://vue3-course-api.hexschool.io/api/qing-api/cart/${t.id}`;i.cartLoading=t.id;const a={product_id:t.product_id,qty:t.qty};s.Z.put(e,{data:a}).then((t=>{i.cartLoading="",this.getCart()}))},removeCartItem(t){const e=`https://vue3-course-api.hexschool.io/api/qing-api/cart/${t}`;i.isLoading=!0,s.Z["delete"](e).then((t=>{i.isLoading=!1,console.log(t),i.pushMessage(t,{title:"刪除"}),this.getCart()}))}}})},4238:function(t,e,a){var s=a(4311),o=a(1020),l=a(6294);const i=(0,l.Z)();e["Z"]=(0,o.Q_)("productStore",{state:()=>({products:[]}),getters:{sortProducts:t=>t.products.sort(((t,e)=>t.price-e.price))},actions:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/qing-api/products/all";i.isLoading=!0,s.Z.get(t).then((t=>{this.products=t.data.products,console.log("products:",t),i.isLoading=!1}))}}})},6294:function(t,e,a){a(7658);var s=a(1020);e["Z"]=(0,s.Q_)("statusStore",{state:()=>({isLoading:!1,cartLoading:"",messages:[]}),actions:{pushMessage(t,e){const{title:a="更新",content:s,style:o="success"}=e;t.data.success?this.messages.push({style:o,title:`${a}成功`,content:s}):this.messages.push({style:"danger",title:`${a}失敗`,content:message.join("、")})}}})},486:function(t,e,a){a.r(e),a.d(e,{default:function(){return it}});var s=a(3396),o=a(7139),l=a(9242);const i={class:"container"},r={class:"row mt-4"},n={class:"col-md-7"},d={class:"table align-middle"},c=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"圖片"),(0,s._)("th",null,"商品名稱"),(0,s._)("th",null,"價格"),(0,s._)("th")])],-1),u={style:{width:"200px"}},p={href:"#",class:"text-dark"},m={key:0,class:"h5"},g={key:1,class:"h6"},h={key:2,class:"h5"},_={class:"btn-group btn-group-sm"},b=["onClick"],f=["onClick","disabled"],v={key:0,class:"spinner-grow spinner-grow-sm text-danger",role:"status"},y={class:"col-md-5"},k={class:"sticky-top"},C={class:"table align-middle"},w=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th"),(0,s._)("th",null,"品名"),(0,s._)("th",{style:{width:"110px"}},"數量"),(0,s._)("th",null,"單價")])],-1),x=["disabled","onClick"],q=(0,s._)("i",{class:"bi bi-x"},null,-1),L=[q],V={key:0,class:"text-success"},Z={class:"input-group input-group-sm"},$=["onChange","disabled","onUpdate:modelValue"],D={class:"input-group-text"},U={class:"text-end"},z={key:0,class:"text-success"},W=(0,s._)("td",{colspan:"3",class:"text-end"},"總計",-1),P={class:"text-end"},I={key:0},j=(0,s._)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),S={class:"text-end text-success"},M={class:"input-group mb-3 input-group-sm"},E={class:"input-group-append"},H={class:"my-5 row justify-content-center"},Q={class:"mb-3"},T=(0,s._)("label",{for:"email",class:"form-label"},"Email",-1),Y={class:"mb-3"},F=(0,s._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),K={class:"mb-3"},O=(0,s._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),A={class:"mb-3"},B=(0,s._)("label",{for:"address",class:"form-label"},"收件人地址",-1),G={class:"mb-3"},J=(0,s._)("label",{for:"message",class:"form-label"},"留言",-1),N=(0,s._)("div",{class:"text-end"},[(0,s._)("button",{class:"btn btn-danger"},"送出訂單")],-1);function R(t,e,a,q,R,X){const tt=(0,s.up)("Loading"),et=(0,s.up)("Field"),at=(0,s.up)("ErrorMessage"),st=(0,s.up)("Form");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(tt,{active:t.isLoading},null,8,["active"]),(0,s._)("div",i,[(0,s._)("div",r,[(0,s._)("div",n,[(0,s._)("table",d,[c,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.sortProducts,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",u,[(0,s._)("div",{style:(0,o.j5)([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${e.imageUrl})`}])},null,4)]),(0,s._)("td",null,[(0,s._)("a",p,(0,o.zw)(e.title),1)]),(0,s._)("td",null,[e.price?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",m,(0,o.zw)(e.origin_price)+" 元 ",1)),e.price?((0,s.wg)(),(0,s.iD)("del",g,"原價 "+(0,o.zw)(e.origin_price)+" 元",1)):(0,s.kq)("",!0),e.price?((0,s.wg)(),(0,s.iD)("div",h," 現在只要 "+(0,o.zw)(e.price)+" 元 ",1)):(0,s.kq)("",!0)]),(0,s._)("td",null,[(0,s._)("div",_,[(0,s._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t=>X.getProduct(e.id)}," 查看更多 ",8,b),(0,s._)("button",{type:"button",class:"btn btn-outline-danger",onClick:a=>t.addToCart(e.id),disabled:t.cartLoading==e.id},[t.cartLoading==e.id?((0,s.wg)(),(0,s.iD)("span",v)):(0,s.kq)("",!0),(0,s.Uk)(" 加到購物車 ")],8,f)])])])))),128))])])]),(0,s._)("div",y,[(0,s._)("div",k,[(0,s._)("table",C,[w,(0,s._)("tbody",null,[t.cart.carts?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(t.cart.carts,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",null,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:t.cartLoading===e.id,onClick:a=>t.removeCartItem(e.id)},L,8,x)]),(0,s._)("td",null,[(0,s.Uk)((0,o.zw)(e.product.title)+" ",1),e.coupon?((0,s.wg)(),(0,s.iD)("div",V," 已套用優惠券 ")):(0,s.kq)("",!0)]),(0,s._)("td",null,[(0,s._)("div",Z,[(0,s.wy)((0,s._)("input",{type:"number",class:"form-control",min:"1",onChange:a=>t.updateCart(e),disabled:e.id==t.cartLoading,"onUpdate:modelValue":t=>e.qty=t},null,40,$),[[l.nr,e.qty,void 0,{number:!0}]]),(0,s._)("div",D," / "+(0,o.zw)(e.product.unit),1)])]),(0,s._)("td",U,[t.cart.final_total!==t.cart.total?((0,s.wg)(),(0,s.iD)("small",z,"折扣價：")):(0,s.kq)("",!0),(0,s.Uk)(" "+(0,o.zw)(t.$filters.currency(e.final_total)),1)])])))),128)):(0,s.kq)("",!0)]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[W,(0,s._)("td",P,(0,o.zw)(t.$filters.currency(t.cart.total)),1)]),t.cart.final_total!==t.cart.total?((0,s.wg)(),(0,s.iD)("tr",I,[j,(0,s._)("td",S,(0,o.zw)(t.$filters.currency(t.cart.final_total)),1)])):(0,s.kq)("",!0)])]),(0,s._)("div",M,[(0,s.wy)((0,s._)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=t=>R.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[l.nr,R.coupon_code]]),(0,s._)("div",E,[(0,s._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[1]||(e[1]=(...t)=>X.addCouponCode&&X.addCouponCode(...t))}," 套用優惠碼 ")])])])])]),(0,s._)("div",H,[(0,s.Wm)(st,{class:"col-md-6",onSubmit:X.createOrder},{default:(0,s.w5)((({errors:t})=>[(0,s._)("div",Q,[T,(0,s.Wm)(et,{id:"email",name:"email",type:"email",class:(0,o.C_)(["form-control",{"is-invalid":t["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:R.form.user.email,"onUpdate:modelValue":e[2]||(e[2]=t=>R.form.user.email=t)},null,8,["class","modelValue"]),(0,s.Wm)(at,{name:"email",class:"invalid-feedback"})]),(0,s._)("div",Y,[F,(0,s.Wm)(et,{id:"name",name:"姓名",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:R.form.user.name,"onUpdate:modelValue":e[3]||(e[3]=t=>R.form.user.name=t)},null,8,["class","modelValue"]),(0,s.Wm)(at,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",K,[O,(0,s.Wm)(et,{id:"tel",name:"電話",type:"tel",class:(0,o.C_)(["form-control",{"is-invalid":t["電話"]}]),placeholder:"請輸入電話",rules:"required",modelValue:R.form.user.tel,"onUpdate:modelValue":e[4]||(e[4]=t=>R.form.user.tel=t)},null,8,["class","modelValue"]),(0,s.Wm)(at,{name:"電話",class:"invalid-feedback"})]),(0,s._)("div",A,[B,(0,s.Wm)(et,{id:"address",name:"地址",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":t["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:R.form.user.address,"onUpdate:modelValue":e[5]||(e[5]=t=>R.form.user.address=t)},null,8,["class","modelValue"]),(0,s.Wm)(at,{name:"地址",class:"invalid-feedback"})]),(0,s._)("div",G,[J,(0,s.wy)((0,s._)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[6]||(e[6]=t=>R.form.message=t)},null,512),[[l.nr,R.form.message]])]),N])),_:1},8,["onSubmit"])])])],64)}a(7658);var X=a(1020),tt=a(4238),et=a(4677),at=a(6294),st={data(){return{product:{},coupon_code:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},computed:{...(0,X.rn)(tt.Z,["sortProducts"]),...(0,X.rn)(et.Z,["cart"]),...(0,X.rn)(at.Z,["isLoading","cartLoading"])},methods:{...(0,X.nv)(tt.Z,["getProducts"]),...(0,X.nv)(et.Z,["addToCart","getCart","updateCart","removeCartItem"]),getProduct(t){this.$router.push(`/user/product/${t}`)},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/qing-api/coupon",e={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:e}).then((t=>{this.isLoading=!1,console.log(t),this.getCart()}))},createOrder(){const t="https://vue3-course-api.hexschool.io/api/qing-api/order",e=this.form;this.$http.post(t,{data:e}).then((t=>{console.log(t.data.orderId),this.getCart(),this.$router.push(`/user/checkout/${t.data.orderId}`)}))}},created(){this.getProducts(),this.getCart()}},ot=a(89);const lt=(0,ot.Z)(st,[["render",R]]);var it=lt}}]);
//# sourceMappingURL=486.a1f69474.js.map