"use strict";(self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[]).push([[874],{4677:function(t,e,a){var o=a(4311),s=a(1020),l=a(6294);const i=(0,l.Z)();e["Z"]=(0,s.Q_)("cartStore",{state:()=>({cart:[]}),actions:{addToCart(t,e=1){i.cartLoading=t;const a="https://vue3-course-api.hexschool.io/api/qing-api/cart",s={product_id:t,qty:e};o.Z.post(a,{data:s}).then((t=>{i.cartLoading="",i.pushMessage(t.data.success,{title:"加入購物車"}),this.getCart()}))},getCart(){const t="https://vue3-course-api.hexschool.io/api/qing-api/cart";i.isLoading=!0,o.Z.get(t).then((t=>{this.cart=t.data.data,i.isLoading=!1}))},updateCart(t,e){console.log(t);const a=`https://vue3-course-api.hexschool.io/api/qing-api/cart/${t.id}`;i.isLoading=!0,i.cartLoading=t.id;const s={product_id:t.product_id,qty:e};o.Z.put(a,{data:s}).then((()=>{i.isLoading=!1,i.cartLoading="",this.getCart()}))},removeCartItem(t){const e=`https://vue3-course-api.hexschool.io/api/qing-api/cart/${t}`;i.isLoading=!0,o.Z["delete"](e).then((t=>{t.data.success&&(i.isLoading=!1,console.log(t),i.pushMessage(t.data.success,{title:"刪除"}),this.getCart())}))}}})},4238:function(t,e,a){var o=a(4311),s=a(1020),l=a(6294);const i=(0,l.Z)();e["Z"]=(0,s.Q_)("productStore",{state:()=>({products:[],isLoadSkeleton:!0}),actions:{loadImg(t){const e=[...t];let a=0;e.forEach((t=>{const o=new Image;o.src=t,o.addEventListener("load",(()=>{a+=1,a===e.length&&(this.isLoadSkeleton=!1)}))}))},getProducts(){const t="https://vue3-course-api.hexschool.io/api/qing-api/products/all";i.isLoading=!0,o.Z.get(t).then((t=>{const e=t.data.products.map((t=>[t.imageUrl]));this.loadImg([].concat(...e)),this.products=t.data.products,i.isLoading=!1}))}}})},1200:function(t,e,a){a.d(e,{Z:function(){return g}});var o=a(3396),s=a(7139);const l={class:"process"},i=(0,o._)("article",null,[(0,o._)("h2",{class:"active"},"1"),(0,o._)("p",null,"購物車")],-1),n=(0,o._)("p",null,"填寫資料",-1),c=(0,o._)("p",null,"確認訂單",-1),d=(0,o._)("p",null,"訂單完成",-1);function r(t,e,a,r,u,p){return(0,o.wg)(),(0,o.iD)("section",l,[i,(0,o._)("article",null,[(0,o._)("h2",{class:(0,s.C_)({active:"/material"==this.$route.path||this.$route.path==`/material/${a.orderId}`||this.$route.path==`/orderCompleted/${a.orderId}`})}," 2 ",2),n]),(0,o._)("article",null,[(0,o._)("h2",{class:(0,s.C_)({active:this.$route.path==`/material/${a.orderId}`||this.$route.path==`/orderCompleted/${a.orderId}`})}," 3 ",2),c]),(0,o._)("article",null,[(0,o._)("h2",{class:(0,s.C_)({active:this.$route.path==`/orderCompleted/${a.orderId}`})}," 4 ",2),d])])}var u={props:["orderId"],created(){}},p=a(89);const h=(0,p.Z)(u,[["render",r]]);var g=h},1017:function(t,e,a){a.r(e),a.d(e,{default:function(){return K}});var o=a(3396),s=a(9242),l=a(7139);const i=(0,o._)("div",{class:"loadingio-spinner-double-ring-juf8237g2sc"},[(0,o._)("div",{class:"ldio-1prs6fceeog"},[(0,o._)("div"),(0,o._)("div"),(0,o._)("div",null,[(0,o._)("div")]),(0,o._)("div",null,[(0,o._)("div")])])],-1),n={class:"container-md user-cart"},c={key:0,class:"mt-4"},d={class:"table-responsive"},r={class:"table"},u=(0,o._)("thead",{class:""},[(0,o._)("tr",{class:""},[(0,o._)("th",{scope:"col",class:"py-3",width:"10%"},"圖片"),(0,o._)("th",{scope:"col",width:"30%"},"商品名稱"),(0,o._)("th",{scope:"col",width:"16%"},"數量"),(0,o._)("th",{scope:"col",width:"36%"},"金額"),(0,o._)("th",{scope:"col",width:"10%"})])],-1),p=["src"],h={class:"d-sm-none mt-1"},g={class:"align-middle d-none d-sm-table-cell"},_={class:"align-middle"},m={class:"d-flex count-group"},f=["onClick","disabled"],b=["onChange","disabled","onUpdate:modelValue"],v=["onClick","disabled"],w={class:"align-middle"},C={key:0,class:"text-muted text-decoration-line-through d-block",style:{"font-size":"14px"}},y={class:"align-middle"},$=["disabled","onClick"],k=(0,o._)("i",{class:"bi bi-trash3"},null,-1),x=[k],L=(0,o._)("tfoot",null,[(0,o._)("tr",null,[(0,o._)("td",{colspan:"5"})])],-1),Z={class:"d-sm-flex justify-content-center align-items-center gap-5"},q={class:"input-group"},M={class:"input-group-append"},D={class:"d-flex align-items-end flex-column mt-5 gap-3"},I={class:"d-flex justify-content-between mt-4"},W={class:"fw-bold align-self-center fs-4"},U={key:1,class:"empty-cart"},z={class:""},T=(0,o._)("h2",null,"目前您的購物車沒有任何商品!",-1);function j(t,e,a,k,j,N){const P=(0,o.up)("Loading"),S=(0,o.up)("process"),V=(0,o.up)("router-link"),A=(0,o.up)("DelModal");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(P,{active:t.isLoading},{default:(0,o.w5)((()=>[i])),_:1},8,["active"]),(0,o._)("main",n,[(0,o.Wm)(S),(0,o.Wm)(s.uT,{name:"switch",mode:"out-in"},{default:(0,o.w5)((()=>[t.cart.total?((0,o.wg)(),(0,o.iD)("section",c,[(0,o._)("div",d,[(0,o._)("table",r,[u,(0,o.Wm)(s.W3,{tag:"tbody",name:"list",appear:""},{default:(0,o.w5)((()=>[t.cart?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:0},(0,o.Ko)(t.cart.carts,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.id},[(0,o._)("td",null,[(0,o.Wm)(V,{to:{name:"product",params:{product:e.product_id},query:{name:e.product.title}}},{default:(0,o.w5)((()=>[(0,o._)("img",{src:e.product.imageUrl,alt:"產品圖",width:"100",height:"100",style:{"object-fit":"cover"}},null,8,p)])),_:2},1032,["to"]),(0,o._)("h2",h,(0,l.zw)(e.product.title),1)]),(0,o._)("td",g,(0,l.zw)(e.product.title)+" ",1),(0,o._)("td",_,[(0,o._)("div",m,[(0,o._)("button",{type:"button",class:"btn btn-light fs-5 rounded-0",onClick:a=>t.updateCart(e,--e.qty),disabled:e.id==t.cartLoading||e.qty<=1}," - ",8,f),(0,o.wy)((0,o._)("input",{type:"number",class:"form-control text-center rounded-0",min:"1",onChange:a=>t.updateCart(e,e.qty),disabled:e.id==t.cartLoading,"onUpdate:modelValue":t=>e.qty=t},null,40,b),[[s.nr,e.qty,void 0,{number:!0}]]),(0,o._)("button",{type:"button",class:"btn btn-light fs-5 rounded-0",onClick:a=>t.updateCart(e,++e.qty),disabled:e.id==t.cartLoading}," + ",8,v)])]),(0,o._)("td",w,[t.cart.final_total!==t.cart.total?((0,o.wg)(),(0,o.iD)("small",C,"NT$ "+(0,l.zw)(t.$filters.currency(e.total)),1)):(0,o.kq)("",!0),(0,o.Uk)(" NT$ "+(0,l.zw)(t.$filters.currency(e.final_total)),1)]),(0,o._)("td",y,[(0,o._)("a",{href:"#",class:"text-secondary",disabled:t.cartLoading===e.id,onClick:(0,s.iM)((a=>t.removeCartItem(e.id)),["prevent"])},x,8,$)])])))),128)):(0,o.kq)("",!0)])),_:1}),L]),(0,o._)("div",Z,[(0,o._)("button",{type:"button",class:"btn btn-brown text-white w-100 mb-3 mb-sm-0",onClick:e[0]||(e[0]=(...t)=>N.openDelModal&&N.openDelModal(...t))}," 清空購物車 "),(0,o._)("div",q,[(0,o.wy)((0,o._)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>j.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[s.nr,j.coupon_code]]),(0,o._)("div",M,[(0,o._)("button",{class:"btn btn-brown text-white rounded-0 rounded-end",type:"button",onClick:e[2]||(e[2]=(...t)=>N.addCouponCode&&N.addCouponCode(...t))}," 套用優惠碼 ")])])]),(0,o._)("article",D,[(0,o._)("p",null,"小計: NT$ "+(0,l.zw)(t.$filters.currency(t.cart.total)),1),(0,o._)("p",null," 折扣金額: NT$ "+(0,l.zw)(t.$filters.currency(t.cart.final_total-t.cart.total)),1)]),(0,o._)("article",I,[(0,o.Wm)(V,{to:"/products?category=全部",class:"btn btn-yellow-deep text-white"},{default:(0,o.w5)((()=>[(0,o.Uk)("繼續購物")])),_:1}),(0,o._)("p",W," 總計: NT$ "+(0,l.zw)(t.$filters.currency(t.cart.final_total)),1),(0,o.Wm)(V,{to:"/material",class:"btn btn-yellow text-white"},{default:(0,o.w5)((()=>[(0,o.Uk)("下一步")])),_:1})])])])):((0,o.wg)(),(0,o.iD)("section",U,[(0,o._)("article",z,[T,(0,o.Wm)(V,{to:"/products?category=全部",class:"btn btn-yellow text-white"},{default:(0,o.w5)((()=>[(0,o.Uk)("來去購物")])),_:1})])]))])),_:1})]),(0,o.Wm)(A,{ref:"delModal",onDelItem:N.delAllCart},null,8,["onDelItem"])],64)}a(7658);var N=a(1020),P=a(4238),S=a(4677),V=a(6294),A=a(1200),E=a(6823),H={components:{process:A.Z,DelModal:E.Z},data(){return{product:{},coupon_code:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},computed:{...(0,N.rn)(S.Z,["cart"]),...(0,N.rn)(V.Z,["isLoading","cartLoading"])},methods:{...(0,N.nv)(P.Z,["getProducts"]),...(0,N.nv)(S.Z,["addToCart","getCart","updateCart","removeCartItem"]),...(0,N.nv)(V.Z,["pushMessage"]),getProduct(t){this.$router.push(`/user/product/${t}`)},openDelModal(){this.$refs.delModal.showModal()},delAllCart(){const t="https://vue3-course-api.hexschool.io/api/qing-api/carts";this.$http.delete(t).then((t=>{this.$refs.delModal.hideModal(),this.pushMessage(t.data.success,{title:"清除"}),this.getCart()}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/qing-api/coupon",e={code:this.coupon_code};this.$http.post(t,{data:e}).then((t=>{console.log(t),this.getCart()}))}},created(){this.getCart(),this.getProducts()}},Q=a(89);const Y=(0,Q.Z)(H,[["render",j]]);var K=Y}}]);
//# sourceMappingURL=874.32145b47.js.map